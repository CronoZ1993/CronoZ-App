<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CronoZ - Seu App Completo</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase v9 (Modular) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getStorage } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBIvOoNLoVMqITyAVRI_9ASOIi9ANIlrkQ",
            authDomain: "cronoz-app-2026.firebaseapp.com",
            projectId: "cronoz-app-2026",
            storageBucket: "cronoz-app-2026.firebasestorage.app",
            messagingSenderId: "961118541246",
            appId: "1:961118541246:web:5b8afd85ecfa41969795ef",
            measurementId: "G-5MKXDX2HR6"
        };

        try {
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const db = getFirestore(app);
            const storage = getStorage(app);
            const googleProvider = new GoogleAuthProvider();

            // Disponibilizar globalmente
            window.auth = auth;
            window.db = db;
            window.storage = storage;
            window.googleProvider = googleProvider;

            console.log('‚úÖ Firebase v9 inicializado com sucesso!');

            // Monitorar autentica√ß√£o
            onAuthStateChanged(auth, (user) => {
                console.log('üîÑ Estado de autentica√ß√£o alterado:', user ? 'Logado' : 'Deslogado');
                
                if (user) {
                    console.log('üë§ Usu√°rio logado:', user.email);
                    
                    // Definir currentUser globalmente
                    window.currentUser = user;
                    
                    // Mostrar tela do app
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('app-screen').style.display = 'block';
                    document.body.classList.add('app-loaded');
                    
                    // Inicializar app ap√≥s 100ms para garantir DOM
                    setTimeout(() => {
                        if (window.initApp) {
                            window.initApp();
                        } else {
                            console.error('‚ùå initApp n√£o encontrado');
                            // For√ßar recarregamento do script
                            loadScript('script.js', () => {
                                if (window.initApp) {
                                    window.initApp();
                                }
                            });
                        }
                    }, 100);
                    
                } else {
                    console.log('üë§ Nenhum usu√°rio logado');
                    document.getElementById('login-screen').style.display = 'flex';
                    document.getElementById('app-screen').style.display = 'none';
                    document.body.classList.remove('app-loaded');
                }
            });

        } catch (error) {
            console.error('‚ùå Erro ao inicializar Firebase:', error);
        }

        function loadScript(src, callback) {
            const script = document.createElement('script');
            script.src = src;
            script.onload = callback;
            document.head.appendChild(script);
        }
    </script>
</head>
<body>
    <!-- TELA DE LOGIN -->
    <div id="login-screen" class="screen">
        <div class="login-container">
            <div class="login-logo">
                <div class="logo-icon">
                    <i class="fas fa-clock"></i>
                    <span class="logo-z">Z</span>
                </div>
                <h1>CronoZ</h1>
                <p>Conectando momentos, preservando mem√≥rias</p>
            </div>
            
            <div class="login-form">
                <div class="form-group">
                    <label for="email">
                        <i class="fas fa-envelope"></i> E-mail
                    </label>
                    <input 
                        type="email" 
                        id="email" 
                        class="form-control" 
                        placeholder="seu@email.com" 
                        value="teste@cronoz.com"
                        autocomplete="email"
                    >
                </div>
                
                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i> Senha
                    </label>
                    <div class="input-with-icon">
                        <input 
                            type="password" 
                            id="password" 
                            class="form-control" 
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                            value="123456"
                            autocomplete="current-password"
                        >
                        <button class="toggle-password" type="button" id="toggle-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div id="login-error" class="error-message" style="display: none; color: red; padding: 10px; background: rgba(255,0,0,0.1); border-radius: 5px; margin-bottom: 15px;"></div>
                
                <div class="login-actions">
                    <button id="login-btn" class="btn primary">
                        <i class="fas fa-sign-in-alt"></i> Entrar
                    </button>
                    
                    <div class="divider">
                        <span>ou</span>
                    </div>
                    
                    <button id="google-login-btn" class="btn secondary">
                        <i class="fab fa-google"></i> Continuar com Google
                    </button>
                    
                    <button id="register-btn" class="btn outline">
                        <i class="fas fa-user-plus"></i> Criar Conta
                    </button>
                </div>
            </div>
        </div>
    </div>

        <!-- TELA DO APP -->
    <div id="app-screen" class="screen" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-clock"></i>
                        <span class="logo-z">Z</span>
                    </div>
                    <h1 class="app-title" id="page-title">CronoZ</h1>
                </div>
            </div>
            
            <div class="header-right">
                <button class="btn-icon" id="notifications-btn">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">0</span>
                </button>
            </div>
        </header>

        <!-- Conte√∫do Principal -->
        <main class="app-content" id="app-content">
            <!-- Conte√∫do ser√° carregado aqui -->
        </main>

        <!-- Footer Navigation (Mobile) -->
        <footer class="app-footer">
            <button class="footer-btn active" data-page="home">
                <i class="fas fa-home"></i>
                <span>In√≠cio</span>
            </button>
            <button class="footer-btn" data-page="contacts">
                <i class="fas fa-users"></i>
                <span>Contatos</span>
            </button>
            <button class="footer-btn" data-page="chat">
                <i class="fas fa-comment"></i>
                <span>Chat</span>
            </button>
            <button class="footer-btn" data-page="calendar">
                <i class="fas fa-calendar"></i>
                <span>Calend√°rio</span>
            </button>
            <button class="footer-btn" data-page="tree">
                <i class="fas fa-tree"></i>
                <span>√Årvore</span>
            </button>
        </footer>
    </div>

    <!-- Scripts -->
    <script>
        // Vers√£o simplificada do script.js para diagn√≥stico
        console.log('üîÑ Script.js carregado');
        
        // Fun√ß√£o global para inicializar o app
        window.initApp = function() {
            console.log('üöÄ Inicializando CronoZ App...');
            
            // Verificar se Firebase est√° dispon√≠vel
            if (!window.auth || !window.db) {
                console.error('‚ùå Firebase n√£o dispon√≠vel');
                return;
            }
            
            // Verificar usu√°rio atual
            const user = auth.currentUser;
            if (!user) {
                console.error('‚ùå Nenhum usu√°rio logado');
                return;
            }
            
            console.log('üë§ Usu√°rio atual:', user.email);
            
            // Carregar p√°gina inicial
            loadHomePage();
            
            // Configurar navega√ß√£o
            setupNavigation();
            
            console.log('‚úÖ CronoZ inicializado com sucesso!');
        };
        
        function loadHomePage() {
            console.log('üìÑ Carregando p√°gina inicial...');
            
            const content = document.getElementById('app-content');
            if (!content) {
                console.error('‚ùå Elemento app-content n√£o encontrado');
                return;
            }

        // Conte√∫do simples de teste
            content.innerHTML = `
                <div class="page-content" style="padding: 20px;">
                    <div class="tray-card" style="background: var(--card-bg); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid var(--border-color);">
                        <h2 style="color: var(--text-color); margin-bottom: 10px;">üéâ Bem-vindo ao CronoZ!</h2>
                        <p style="color: var(--text-secondary);">Seu app est√° funcionando corretamente.</p>
                        <p style="color: var(--text-secondary); margin-top: 10px;">
                            <strong>Usu√°rio:</strong> ${auth.currentUser?.email || 'N√£o identificado'}
                        </p>
                        <button onclick="testFirebase()" class="btn primary" style="margin-top: 15px;">
                            Testar Conex√£o Firebase
                        </button>
                    </div>
                    
                    <div class="tray-card" style="background: var(--card-bg); border-radius: 12px; padding: 20px; border: 1px solid var(--border-color);">
                        <h3 style="color: var(--text-color); margin-bottom: 10px;">üì± Menu R√°pido</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-top: 15px;">
                            <button onclick="loadPage('contacts')" class="btn secondary">
                                <i class="fas fa-users"></i> Contatos
                            </button>
                            <button onclick="loadPage('calendar')" class="btn secondary">
                                <i class="fas fa-calendar"></i> Calend√°rio
                            </button>
                            <button onclick="loadPage('tree')" class="btn secondary">
                                <i class="fas fa-tree"></i> √Årvore
                            </button>
                            <button onclick="loadPage('settings')" class="btn secondary">
                                <i class="fas fa-cog"></i> Configura√ß√µes
                            </button>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px; color: var(--text-secondary); font-size: 14px;">
                        <p>CronoZ v1.0.0 - Firebase conectado ‚úì</p>
                    </div>
                </div>
            `;
            
            // Atualizar t√≠tulo
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.innerHTML = '<i class="fas fa-home"></i> In√≠cio';
            }
            
            console.log('‚úÖ P√°gina inicial carregada');
        }
        
        function setupNavigation() {
            console.log('üîó Configurando navega√ß√£o...');
            
            // Bot√µes do footer
            const footerButtons = document.querySelectorAll('.footer-btn');
            footerButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    
                    // Atualizar bot√£o ativo
                    footerButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Carregar p√°gina
                    loadPage(page);
                });
            });
            
            // Bot√£o menu hamb√∫rguer
            const menuToggle = document.getElementById('menu-toggle');
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    alert('Menu sidebar em desenvolvimento');
                });
            }
            
            // Bot√£o notifica√ß√µes
            const notificationsBtn = document.getElementById('notifications-btn');
            if (notificationsBtn) {
                notificationsBtn.addEventListener('click', function() {
                    alert('Notifica√ß√µes em desenvolvimento');
                });
            }
            
            console.log('‚úÖ Navega√ß√£o configurada');
        }
        
        function loadPage(page) {
            console.log(`üìÑ Carregando p√°gina: ${page}`);
            
            const titles = {
                'home': 'In√≠cio',
                'contacts': 'Contatos',
                'chat': 'Chat',
                'calendar': 'Calend√°rio',
                'tree': '√Årvore Geneal√≥gica',
                'settings': 'Configura√ß√µes'
            };
            
            // Atualizar t√≠tulo
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.innerHTML = `<i class="fas fa-${getPageIcon(page)}"></i> ${titles[page] || 'CronoZ'}`;
            }
            
            // Conte√∫do simples para teste
            const content = document.getElementById('app-content');
            content.innerHTML = `
                <div class="page-content" style="padding: 20px;">
                    <div class="tray-card" style="background: var(--card-bg); border-radius: 12px; padding: 20px; border: 1px solid var(--border-color);">
                        <h2 style="color: var(--text-color); margin-bottom: 10px;">
                            <i class="fas fa-${getPageIcon(page)}"></i> ${titles[page] || 'P√°gina'}
                        </h2>
                        <p style="color: var(--text-secondary);">
                            Esta funcionalidade est√° em desenvolvimento.
                        </p>
                        <p style="color: var(--text-secondary); margin-top: 10px;">
                            <strong>P√°gina:</strong> ${page}
                        </p>
                        <button onclick="loadHomePage()" class="btn primary" style="margin-top: 15px;">
                            <i class="fas fa-home"></i> Voltar para In√≠cio
                        </button>
                    </div>
                </div>
            `;
        }

        function getPageIcon(page) {
            const icons = {
                'home': 'home',
                'contacts': 'users',
                'chat': 'comments',
                'calendar': 'calendar-alt',
                'tree': 'tree',
                'settings': 'cog',
                'albums': 'images'
            };
            return icons[page] || 'file';
        }
        
        // Fun√ß√£o de teste Firebase
        window.testFirebase = async function() {
            try {
                alert('Testando conex√£o Firebase...\n\nUsu√°rio: ' + auth.currentUser?.email);
                
                // Tentar ler dados do usu√°rio
                const userDoc = await getDoc(doc(db, 'users', auth.currentUser.uid));
                
                if (userDoc.exists()) {
                    alert('‚úÖ Firebase funcionando!\n\nDados do usu√°rio carregados com sucesso.');
                } else {
                    alert('‚ö†Ô∏è Firebase funcionando, mas usu√°rio n√£o tem dados ainda.');
                }
            } catch (error) {
                alert('‚ùå Erro no Firebase:\n\n' + error.message);
            }
        };
        
        // Fun√ß√µes Firebase helpers (simplificadas)
        async function getDoc(docRef) {
            const { getDoc: getDocFn } = await import("https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js");
            return getDocFn(docRef);
        }
        
        function doc(db, path, ...pathSegments) {
            const { doc: docFn } = window.firebase?.firestore || {};
            if (docFn) return docFn(db, path, ...pathSegments);
            return { path }; // Fallback
        }
        
        // Auto-inicializar se j√° estiver logado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± DOM totalmente carregado');
            
            // Se j√° tiver usu√°rio logado, inicializar app
            if (window.auth?.currentUser) {
                console.log('üë§ Usu√°rio j√° est√° logado, inicializando...');
                setTimeout(() => {
                    if (window.initApp) window.initApp();
                }, 500);
            }
        });
        
        console.log('‚úÖ Script.js pronto');
    </script>
    
    <!-- Vers√£o -->
    <div class="app-version">CronoZ v1.0.0</div>
</body>
</html>
```
